import{r as p,S as b,W as S,Z as E,P as A,j as e,m as o,A as v,B as w,C as j,a as N,g as C,c as k,t as h}from"./index-ClS7RV9A.js";const d=[{id:"analyze",label:"Analyzing Product Assets",icon:b,color:"text-blue-500"},{id:"prompt",label:"Calibrating Neural Style",icon:S,color:"text-purple-500"},{id:"generate",label:"Synthesizing Visual Content",icon:E,color:"text-yellow-500"},{id:"refine",label:"Optimizing Composition",icon:A,color:"text-pink-500"}];function U({status:a,onCancel:f}){const[r,u]=p.useState(0);p.useEffect(()=>{const l=setInterval(()=>{u(s=>(s+1)%d.length)},3e3);return()=>clearInterval(l)},[]);const m=d[r].icon;return e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center p-12 min-h-[400px] border-2 border-dashed border-primary/20 rounded-3xl bg-primary/5 relative overflow-hidden",children:[e.jsx(o.div,{animate:{scale:[1,1.2,1],opacity:[.1,.2,.1]},transition:{duration:4,repeat:1/0},className:"absolute inset-0 bg-primary/10 rounded-full blur-3xl scale-75"}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx(o.div,{animate:{rotate:360},transition:{duration:10,repeat:1/0,ease:"linear"},className:"w-32 h-32 rounded-full border-4 border-primary/10 border-t-primary"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(v,{mode:"wait",children:e.jsx(o.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},className:y("p-4 rounded-full bg-white shadow-xl",d[r].color),children:e.jsx(m,{className:"h-8 w-8"})},r)})})]}),e.jsxs("div",{className:"text-center space-y-4 relative z-10",children:[e.jsx("h3",{className:"text-2xl font-black text-gray-900 uppercase tracking-tighter",children:a==="PROCESSING"?"Generating Ad":"Queuing Request"}),e.jsx("div",{className:"h-8 overflow-hidden",children:e.jsx(v,{mode:"wait",children:e.jsxs(o.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"text-sm font-black uppercase tracking-widest text-primary",children:[d[r].label,"..."]},r)})}),e.jsx("p",{className:"text-xs text-gray-400 font-medium max-w-[280px] mx-auto leading-relaxed",children:"Our specialized Creative AI is processing your request. This typically takes 15-45 seconds."})]}),e.jsx("div",{className:"flex gap-2 mt-8",children:d.map((l,s)=>e.jsx(o.div,{animate:{scale:s===r?[1,1.2,1]:1,opacity:s===r?1:.3},className:y("h-1.5 w-1.5 rounded-full",s===r?"bg-primary":"bg-gray-300")},s))}),e.jsxs(w,{variant:"outline",size:"sm",onClick:f,className:"mt-12 relative z-20 border-red-100 bg-red-50/30 text-red-500/80 hover:text-red-600 hover:bg-red-50 hover:border-red-200 hover:shadow-lg hover:shadow-red-500/5 transition-all duration-300 font-bold uppercase tracking-[0.15em] text-[10px] h-11 px-8 rounded-full flex items-center group",children:[e.jsx(j,{className:"mr-2.5 h-4 w-4 opacity-70 group-hover:opacity-100 group-hover:rotate-90 transition-all duration-500"}),"Stop Generation"]})]})}function y(...a){return a.filter(Boolean).join(" ")}function G(a,f){const r=p.useRef(null),u=N(),m=u.setGeneratedAd,l=u.setGenerationStatus;return p.useEffect(()=>{if(!a)return;console.log("Processing Ad ID: ",a),r.current&&r.current.close();const s=C(),c=new URL(`${k}/ads/${a}/events`);console.log("URL: ",c),s&&c.searchParams.set("token",s),c.searchParams.set("ngrok-skip-browser-warning","1"),console.log(`[SSE] Connecting to: ${c.toString()}`);const i=new EventSource(c.toString(),{withCredentials:!0});return r.current=i,i.onmessage=x=>{try{const t=JSON.parse(x.data);if(console.log("[AdEvents] Received update:",t),t.status==="CONNECTED"){console.log("[AdEvents] SSE Connected for ad:",a);return}l(t.status),t.status==="COMPLETED"&&(h.success("Ad generation complete!",{id:"gen-toast"}),m(g=>{const n=g?.data||g||{};return{...g,data:{...n,status:"COMPLETED",id:t.adId||n.id,previewUrl:t.url||n.previewUrl,url:t.url||n.url,mediaType:t.mediaType||n.mediaType,imageUrls:t.imageUrls||n.imageUrls||[],videoUrls:t.videoUrls||n.videoUrls||[],variants:t.imageUrls||t.videoUrls||n.variants||[]}}}),i.close()),t.status==="FAILED"&&(h.error(`Generation failed: ${t.error}`,{id:"gen-toast"}),i.close()),t.status==="CANCELLED"&&(h.info("Generation cancelled",{id:"gen-toast"}),i.close())}catch(t){console.error("[AdEvents] Failed to parse message:",t)}},i.onerror=x=>{console.error("[AdEvents] SSE Error (Connection might be interrupted, browser will attempt to reconnect):",x)},()=>{r.current&&r.current.close()}},[a,m,l]),null}export{U as A,G as u};
