const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D1F_5BQv.js","assets/index-C4XJeQJR.css"])))=>i.map(i=>d[i]);
import{d as Z,e as F,_ as J,a as S,j as e,L,m as y,f as b,h as ee,i as A,k as I,T,r as w,B as j,I as ae,t as h,l as te,n as se,o as E,p as D,q as re,s as ie,v as ne,w as le,x as oe,y as ce,C as de,z as me,D as xe,W as pe,E as ue,S as ge,F as he,G as ye,H as fe,A as _}from"./index-D1F_5BQv.js";import{categoriesApi as be}from"./index-CAXxMtfI.js";import{u as je,A as ve}from"./useAdEvents-B8HJ-UZl.js";const Ne=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],we=Z("link-2",Ne),ke=a=>F({queryKey:["ad-categories",a],queryFn:()=>be.getCategories(a)}),Se=(a,l)=>F({queryKey:["category-templates",a,l],queryFn:async()=>{if(!a)throw new Error("Category ID is required");const{templateApi:o}=await J(async()=>{const{templateApi:u}=await import("./index-D1F_5BQv.js").then(s=>s.ap);return{templateApi:u}},__vite__mapDeps([0,1])),x=a.includes(",")?a.split(","):[a];return o.getTemplates({categoryIds:x,mediaType:l,page:1,limit:50})},enabled:!!a});function Ce(){const{selectedCategoryId:a,setSelectedCategory:l,goToNextStep:o,options:x}=S(),{data:u,isLoading:s}=ke({limit:50,withTemplatesOnly:!0}),d=u?.data||[],i=new Map;d.forEach(r=>{const g=i.get(r.name);g?(g.templateCount=(g.templateCount||0)+(r.templateCount||0),g.mergedIds||(g.mergedIds=[g.id]),g.mergedIds.push(r.id)):i.set(r.name,{...r,mergedIds:[r.id]})});const m=Array.from(i.values());console.log("Categories for mediaType:",x.mediaType,m);const c=r=>{l(r.join(",")),o()};if(s)return e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(L,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm font-black uppercase tracking-widest text-gray-400",children:"Scanning Categories..."})]})});const p={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},C={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-black text-gray-900 uppercase tracking-tighter",children:["Choose Ad ",e.jsx("span",{className:"text-primary",children:"Type"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-2 font-medium max-w-md mx-auto",children:"Select a category to unlock specialized AI templates optimized for your target audience."})]}),e.jsx(y.div,{variants:p,initial:"hidden",animate:"visible",className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:m.map(r=>{const g=a===r.id;return e.jsx(y.button,{variants:C,onClick:()=>c(r.mergedIds),className:b("group relative p-4 rounded-xl border-2 transition-all duration-300","hover:shadow-xl hover:-translate-y-1",g?"border-primary bg-primary/5 shadow-primary/10":"border-gray-50 bg-white hover:border-primary/30"),children:e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:b("font-black text-xs uppercase tracking-tight mb-1",g?"text-primary":"text-gray-900"),children:r.name}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[r.templateCount!==void 0&&e.jsxs(ee,{variant:g?"default":"secondary",className:b("text-[9px] px-2 py-0 h-4 rounded-full font-black",!g&&"bg-gray-100 text-gray-500 border-none"),children:[r.templateCount," ",r.templateCount===1?"TMPL":"TMPLS"]}),g&&e.jsx(y.div,{initial:{scale:0},animate:{scale:1},className:"h-4 w-4 rounded-full bg-primary flex items-center justify-center",children:e.jsx(A,{className:"h-2.5 w-2.5 text-white"})})]})]})},r.id)})})]})}function Ie({customPrompt:a,setCustomPrompt:l,style:o,setStyle:x,mood:u,setMood:s,variations:d,setVariations:i}){return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-md p-8 shadow-sm space-y-8",children:[e.jsx("h2",{className:"text-lg font-black text-gray-900 uppercase tracking-tighter",children:"Generation Settings"}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx(I,{className:"text-[11px] font-black uppercase tracking-widest text-gray-500 mb-3 block",children:"Campaign Message (Optional)"}),e.jsx(T,{value:a,onChange:m=>l(m.target.value),placeholder:"Describe the atmosphere and key product features...",className:"min-h-[120px] rounded-md border-gray-100 bg-gray-50/50 focus:border-primary transition-colors resize-none"})]})})]})}const U=[{name:"Square",size:"1080 Ã— 1080",ratio:"1:1"},{name:"Landscape",size:"1920 Ã— 1080",ratio:"16:9"},{name:"Portrait",size:"1080 Ã— 1920",ratio:"9:16"},{name:"Facebook",size:"1200 Ã— 628",ratio:"16:9"},{name:"Instagram",size:"1080 Ã— 1350",ratio:"4:5"},{name:"Twitter",size:"1200 Ã— 675",ratio:"16:9"}];function Ae({selectedSize:a,setSelectedSize:l}){return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-md p-6 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-gray-500 mb-4",children:"Ad Size"}),e.jsx("div",{className:"space-y-2",children:U.map((o,x)=>e.jsxs("button",{type:"button",onClick:()=>l(x),className:`w-full text-left p-3 rounded-md border-2 transition-all ${a===x?"border-primary bg-primary/5":"border-gray-100 hover:border-primary/30"}`,children:[e.jsx("div",{className:"font-bold text-sm text-gray-900",children:o.name}),e.jsx("div",{className:"text-xs text-gray-500 font-medium",children:o.size})]},x))})]})}function Pe({scenes:a=[],setScenes:l,duration:o,setDuration:x,videoScript:u,setVideoScript:s}){const d=o==="5"?1:o==="10"?2:3,i=(m,c)=>{const p=[...a];for(;p.length<d;)p.push("");p[m]=c,l?.(p)};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-md p-8 shadow-sm space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{className:"text-[11px] font-black uppercase tracking-widest text-primary mb-3 block",children:"Video Script (Voiceover/Text)"}),e.jsx(T,{value:u?.content||"",onChange:m=>s?.({type:u?.type||"TEXT",content:m.target.value}),placeholder:"Enter the text for AI voiceover or on-screen text...",className:"min-h-[100px] rounded-md border-gray-100 bg-blue-50/30 focus:border-primary transition-colors resize-none text-sm",maxLength:500}),e.jsxs("p",{className:"text-[10px] text-gray-400 font-medium",children:[u?.content?.length||0," / 500 characters"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(I,{className:"text-[11px] font-black uppercase tracking-widest text-gray-500 mb-3 block",children:"Video Duration"}),e.jsx("div",{className:"flex gap-2",children:[5,10,15].map(m=>e.jsxs("button",{onClick:()=>x?.(m.toString()),className:b("px-4 py-2 rounded-md text-[10px] font-black uppercase tracking-widest border transition-all",o===m.toString()?"bg-primary border-primary text-white shadow-lg shadow-primary/20":"bg-white border-gray-100 text-gray-500 hover:border-primary/50"),children:[m," Seconds"]},m))})]}),e.jsx("div",{className:"space-y-6",children:[...Array(d)].map((m,c)=>e.jsxs("div",{children:[e.jsxs(I,{className:"text-[11px] font-black uppercase tracking-widest text-gray-500 mb-3 block",children:["Scene ",c+1," ",c===0?"(Required)":"(Optional)"]}),e.jsx(T,{value:a[c]||"",onChange:p=>i(c,p.target.value),placeholder:`Describe scene ${c+1}...`,className:"min-h-[80px] rounded-md border-gray-100 bg-gray-50/50 focus:border-primary transition-colors resize-none"})]},c))})]})]})}function Te({modelImageUrl:a,onImageChange:l,onFileChange:o,isUploading:x=!1}){const[u,s]=w.useState(!1),[d,i]=w.useState(""),m=()=>{if(!d.trim()){h.error("Please enter a valid URL");return}l(d.trim()),s(!1),i("")},c=()=>{l(null),o(null)};return e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-100 p-8 shadow-2xl shadow-gray-200/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-lg bg-purple-500/10 flex items-center justify-center text-purple-500",children:e.jsx(L,{className:"h-4 w-4"})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tighter",children:"Character Reference"})]}),!a&&e.jsxs(j,{variant:"ghost",size:"sm",onClick:()=>s(!u),className:b("h-9 px-4 rounded-full font-black uppercase tracking-widest text-[10px] transition-all",u?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400 hover:text-blue-500"),children:[e.jsx(we,{className:"h-3 w-3 mr-2"}),u?"Cancel Link":"Link"]})]}),e.jsx("p",{className:"text-xs text-gray-400 mb-6 font-medium",children:"Upload a character reference or provide a link to anchor the AI's generation around a specific human persona."}),u&&!a&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50/50 border border-blue-100 rounded-xl mb-6 animate-in fade-in slide-in-from-top-2",children:[e.jsx(ae,{value:d,onChange:p=>i(p.target.value),placeholder:"Paste image URL here...",className:"flex-1 h-10 border-none bg-transparent focus-visible:ring-0 text-sm font-medium"}),e.jsx(j,{size:"sm",onClick:m,className:"h-8 w-8 p-0 rounded-lg bg-blue-500 hover:bg-blue-600 shadow-lg shadow-blue-200",children:e.jsx(A,{className:"h-4 w-4 text-white"})})]}),e.jsx("div",{className:"space-y-4",children:a?e.jsxs("div",{className:"relative group rounded-2xl overflow-hidden aspect-video border-2 border-gray-100 bg-gray-50",children:[e.jsx("img",{src:a,alt:"Model Reference",className:"w-full h-full object-contain",onError:()=>{h.error("Failed to load reference image"),c()}}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:e.jsxs(j,{variant:"destructive",size:"sm",onClick:c,className:"font-black uppercase tracking-widest text-[10px] rounded-full px-6",children:[e.jsx(te,{className:"h-3 w-3 mr-2"}),"Remove Reference"]})})]}):e.jsx(se,{label:"Upload Persona",description:"Drag & drop or click to upload a human reference",onImageChange:o,isLoading:x,className:"aspect-video"})})]})}function Ee({template:a}){const{goToPreviousStep:l}=S(),o=a.previewImages?.[0]||a.referenceAdImage;return e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-100 p-8 shadow-2xl shadow-gray-200/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"h-8 w-8 rounded-lg bg-orange-500/10 flex items-center justify-center text-orange-500",children:e.jsx(E,{className:"h-4 w-4"})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tighter",children:"Selected Template"})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50/50 rounded-xl border border-gray-100 group transition-all hover:bg-white hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-24 rounded-lg overflow-hidden shrink-0 bg-gray-100 border border-gray-100",children:o?e.jsx("img",{src:o,alt:a.name,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-200",children:e.jsx(E,{className:"h-8 w-8"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-[10px] font-bold text-orange-500 uppercase tracking-widest bg-orange-50 px-2 py-0.5 rounded",children:a.category||"General"})}),e.jsx("h4",{className:"text-sm font-black text-gray-900 uppercase tracking-tight truncate",children:a.name}),e.jsxs("p",{className:"text-[10px] text-gray-400 mt-1 uppercase font-medium",children:[a.variableIds?.length||0," Dynamic Variables"]})]})]}),e.jsx("div",{className:"",children:e.jsxs(j,{variant:"outline",className:"",onClick:()=>{l()},children:[e.jsx(D,{className:"h-4 w-4"}),"Change"]})})]})]})}function Ue(){const{selectedProducts:a,selectedTemplate:l,uploadedImageUrl:o,prompt:x,variableValues:u,options:s,generatedAd:d,generationStatus:i,toggleProduct:m,setUploadedImageUrl:c,setPrompt:p,setVariableValue:C,setOptions:r,setGeneratedAd:g,setGenerationStatus:v,setVideoScript:q,goToPreviousStep:W}=S(),P=re(),{mutateAsync:B}=ie(),[$,G]=w.useState(!1),z=ne();je(d?.data?.id||null);const O=i==="PENDING"||i==="PROCESSING"||P.isPending;w.useEffect(()=>{i==="COMPLETED"&&d?.data?.id&&z({to:`/ads/preview/${d.data.id}`})},[i,d?.data?.id,z]);const V=le({queries:a.filter(t=>!t.id.startsWith("temp_")).map(t=>({queryKey:[t.source==="STORE"?"product":"uploaded-product",t.id],queryFn:()=>t.source==="STORE"?oe.getProductById(t.id):ce.getUploadedProductById(t.id)}))}),M=w.useMemo(()=>{const t=a.filter(n=>!n.id.startsWith("temp_"));return a.map(n=>{if(n.id.startsWith("temp_"))return{id:n.id,title:n.metadata?.title||"Ingested Asset",description:n.metadata?.description,imageUrl:n.metadata?.imageUrl,productSource:"UPLOADED"};const f=t.findIndex(N=>N.id===n.id),k=V[f]?.data?.data;return{id:n.id,title:k?.title||n.metadata?.title||"Product Asset",description:k?.description||n.metadata?.description,images:k?.images||(n.metadata?.imageUrl?[{url:n.metadata.imageUrl}]:[]),imageUrl:k?.images?.[0]?.url||n.metadata?.imageUrl,productSource:n.source}})},[V,a]),H=(t,n,f)=>{t&&m(t,n?"UPLOADED":"STORE",f)},Q=async()=>{if(!s.mediaType){h.error("Generation configuration error. Please try refreshing the page.");return}if(a.length===0&&!o){h.error("Please select or upload a product");return}const t=a[0];if(!t&&!o){h.error("Please select a product");return}v("PENDING"),h.loading("Queuing ad generation...",{id:"gen-toast"});try{const n=t.id.startsWith("temp_");let f=[];a.length>0&&(f=a.map(R=>M.find(Y=>Y.id===R.id)?.imageUrl||R.metadata?.imageUrl).filter(Boolean)),f.length===0&&o&&(f=[o]),f=Array.from(new Set(f));const k={productId:!n&&t?.source==="STORE"?t.id:void 0,uploadedProductId:!n&&t?.source==="UPLOADED"?t.id:void 0,productImageUrls:f,productTitle:n?t.metadata?.title:void 0,templateId:l?.id||void 0,variableValues:u,aspectRatio:s.dimensions,variantsCount:s.variants,style:s.style,mood:s?.mood||void 0,scenes:s.scenes,duration:s?.duration||void 0,mediaType:s?.mediaType||void 0,modelImageUrl:s.modelImageUrl||void 0,prompt:s.mediaType==="IMAGE"?x:void 0,videoScript:s.mediaType==="VIDEO"&&s.videoScript?.content?.trim()?s.videoScript:void 0,title:`Ad for ${t?.metadata?.title||"Product"}`},N=await P.mutateAsync(k);g({data:{id:N.data.id,title:N.data.title||"Generated Ad",mediaType:N.data.mediaType||s.mediaType,status:N.data.status||"PENDING",createdAt:N.data.createdAt}}),h.success("Ad generation started",{id:"gen-toast"})}catch(n){console.error("Failed to generate ad:",n),v("FAILED"),h.error("Generation failed. Please try again.",{id:"gen-toast"})}},K=async()=>{if(v("CANCELLED"),h.info("Generation stopping...",{id:"gen-toast"}),d?.data?.id)try{await ye.cancelAd(d.data.id),h.success("Generation cancelled",{id:"gen-toast"})}catch(t){console.error("Failed to cancel ad:",t),h.error("Generation stopped (Sync issues may occur)",{id:"gen-toast"})}else h.success("Generation aborted",{id:"gen-toast"})},X=async t=>{if(t){G(!0);try{const n=await B({file:t});r({modelImageUrl:n.data.url}),h.success("Reference persona uploaded")}catch{h.error("Upload failed")}finally{G(!1)}}else r({modelImageUrl:null})};return O?e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(ve,{status:i,onCancel:K})}):e.jsxs("div",{className:"space-y-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-4xl font-black text-gray-900 uppercase tracking-tighter",children:["Refine ",e.jsx("span",{className:"text-primary",children:"Generation"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-2 font-medium max-w-sm",children:"Finalize asset composition and calibrate AI parameters for optimal creative output."})]}),e.jsxs(j,{variant:"ghost",onClick:W,className:"px-8 h-12 bg-gray-100 rounded-full font-black uppercase tracking-widest text-[10px] text-gray-400 hover:text-primary transition-colors",children:[e.jsx(D,{className:"mr-2 h-3 w-3"}),"Change Template"]})]}),i==="FAILED"&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-center gap-3 animate-in fade-in slide-in-from-top-2",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-red-100 flex items-center justify-center shrink-0",children:e.jsx(de,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-black text-gray-900 uppercase tracking-wide",children:"Generation Failed"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"We encountered an error while processing your request. Please try again or adjust your settings."})]}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>v("IDLE"),className:"text-red-600 hover:bg-red-100 hover:text-red-700 font-bold uppercase text-[10px] tracking-widest",children:"Dismiss & Retry"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-10",children:[e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-100 p-8 shadow-2xl shadow-gray-200/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"h-8 w-8 rounded-lg bg-blue-500/10 flex items-center justify-center text-blue-500",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tighter",children:"Product Image"})]}),e.jsx(xe,{selectedProducts:M,onProductSelect:H,onImageUploaded:c})]}),l&&e.jsxs("div",{className:"space-y-10",children:[e.jsx(Ee,{template:l}),e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-100 p-8 shadow-2xl shadow-gray-200/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"h-8 w-8 rounded-lg bg-orange-500/10 flex items-center justify-center text-orange-500",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tighter",children:"Template Customizations"})]}),e.jsx(ue,{variables:l.variables||[],values:u,onValueChange:C})]})]}),s.mediaType==="IMAGE"?e.jsx(Ie,{customPrompt:x,setCustomPrompt:p,style:s.style,setStyle:t=>r({style:t}),mood:s.mood,setMood:t=>r({mood:t}),variations:s.variants,setVariations:t=>r({variants:t})}):e.jsx(Pe,{customPrompt:x,setCustomPrompt:p,scenes:s.scenes,setScenes:t=>r({scenes:t}),duration:s.duration?.toString()||"10",setDuration:t=>r({duration:parseInt(t)}),variations:s.variants,setVariations:t=>r({variants:t}),videoScript:s.videoScript,setVideoScript:q}),s.mediaType==="VIDEO"&&e.jsx(Te,{modelImageUrl:s.modelImageUrl||null,onImageChange:t=>r({modelImageUrl:t}),onFileChange:X,isUploading:$})]}),e.jsxs("div",{className:"lg:col-span-4 lg:sticky lg:top-8 h-fit space-y-6",children:[e.jsx(Ae,{selectedSize:U.findIndex(t=>t.ratio===s.dimensions),setSelectedSize:t=>{const n=U[t];n&&r({dimensions:n.ratio})}}),e.jsxs("div",{className:"p-6 rounded-2xl bg-gray-900 text-white shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ge,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-primary",children:"AI Optimization"})]}),e.jsxs("p",{className:"text-xs text-gray-400 mb-6 font-medium leading-relaxed",children:["Your selections are ready for synthesis. Our neural processors will now calibrate for the ",s.dimensions," format."]}),e.jsx("div",{className:"w-full",children:e.jsx(j,{type:"button",onClick:Q,disabled:P.isPending||O,className:"w-full h-16 rounded-xl shadow-2xl shadow-primary/30 bg-primary group hover:scale-[1.02] active:scale-95 transition-all outline-1 outline-white/80",children:e.jsxs("div",{className:"flex flex-col items-center ",children:[e.jsx("span",{className:"text-sm font-black text-white uppercase tracking-[0.2em]",children:"Execute Generation"}),e.jsx("span",{className:"text-[9px] font-bold text-white/50 uppercase tracking-widest mt-0.5",children:"Approx. 30 Seconds"})]})})})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-blue-50/50 border border-blue-100",children:[e.jsx(he,{className:"h-4 w-4 text-blue-500 shrink-0"}),e.jsx("p",{className:"text-[10px] text-blue-600 font-bold leading-normal",children:"Credits will only be deducted upon successful synthesis of the final visual assets."})]})]})]})]})}function Le(){const{selectedCategoryId:a,selectedTemplateId:l,setSelectedTemplate:o,goToNextStep:x,goToPreviousStep:u,options:s}=S(),{data:d,isLoading:i}=Se(a),m=d?.data||[];console.log("CategoryTemplates: ",d);const c=r=>{o(r),x()};if(i)return e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(L,{className:"h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm font-black uppercase tracking-widest text-gray-400",children:"Fetching Templates..."})]})});const p={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},C={hidden:{scale:.9,opacity:0},visible:{scale:1,opacity:1}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(j,{variant:"ghost",onClick:u,className:"px-8 h-12 bg-gray-100 rounded-full font-black uppercase tracking-widest text-[10px] text-gray-400 hover:text-primary transition-colors",children:[e.jsx(D,{className:"mr-2 h-3 w-3"}),"Change Category"]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h2",{className:"text-3xl font-black text-gray-900 uppercase tracking-tighter",children:["Choose ",e.jsx("span",{className:"text-primary",children:"Template"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-2 font-medium max-w-md mx-auto",children:"Choose a structural foundation. Our AI will adapt your product into this layout."})]}),e.jsx("div",{className:"w-auto"})]}),e.jsx(y.div,{variants:p,initial:"hidden",animate:"visible",className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:m.map(r=>{const g=l===r.id,v=r.previewImages?.[0]||r.referenceAdImage;return e.jsxs(y.button,{variants:C,onClick:()=>c(r),className:b("group relative rounded-2xl border-2 transition-all duration-500 overflow-hidden aspect-3/4",g?"border-primary shadow-2xl shadow-primary/20 ring-4 ring-primary/10":"border-gray-50 bg-white hover:border-primary/40"),children:[e.jsx("div",{className:"absolute inset-0 bg-gray-100",children:v?e.jsx("img",{src:v,alt:r.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-50",children:e.jsx(E,{className:"h-8 w-8 text-gray-200"})})}),e.jsx("div",{className:"absolute inset-0 bg-linear-to-t from-black/80 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 text-left",children:[e.jsx("h3",{className:"text-white font-black text-xs uppercase tracking-tight",children:r.name}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsxs("div",{className:"text-[9px] font-bold text-white/70 uppercase tracking-widest bg-white/10 px-2 py-0.5 rounded backdrop-blur-sm",children:[r.variableIds?.length||0," VARS"]})})]})}),g&&e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute top-3 right-3 h-6 w-6 rounded-full bg-primary flex items-center justify-center shadow-lg",children:e.jsx(A,{className:"h-3 w-3 text-white"})})]},r.id)})})]})}function Ve({mediaType:a}){const{currentStep:l,resetFlow:o,selectedProducts:x}=S(),[u,s]=w.useState(!1);if(w.useEffect(()=>{s(!0),S.getState().options.mediaType!==a?(console.warn(`ðŸ›¡ï¸  Flow mismatch detected. Hard resetting to ${a}`),o(a)):console.warn(`âœ… Flow verified: ${a}`)},[a,o]),!u)return e.jsx(fe,{fullScreen:!1});const d=[{number:1,label:"Category",component:e.jsx(Ce,{})},{number:2,label:"Template",component:e.jsx(Le,{})},{number:3,label:"Customize",component:e.jsx(Ue,{})}];return e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(_,{children:x.length>0&&l<3&&e.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-8 flex flex-wrap items-center gap-3 p-4 bg-white rounded-2xl border border-primary/10 shadow-sm",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400 ml-2 mr-2",children:"Working With:"}),x.map(i=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-primary/5 rounded-full border border-primary/10",children:[i.metadata?.imageUrl&&e.jsx("img",{src:i.metadata.imageUrl,alt:"",className:"w-5 h-5 rounded-full object-cover"}),e.jsx("span",{className:"text-[10px] font-bold text-primary uppercase truncate max-w-[120px]",children:i.metadata?.title||"Product Asset"})]},i.id))]})}),e.jsx("div",{className:"mb-12",children:e.jsx("div",{className:"flex items-center justify-center",children:d.map((i,m)=>{const c=l===i.number,p=l>i.number;return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(y.div,{initial:!1,animate:{scale:c?1.1:1,backgroundColor:c||p?"var(--color-primary)":"#fff",borderColor:c||p?"var(--color-primary)":"#d1d5db"},transition:{duration:.3},className:b("relative flex items-center justify-center w-12 h-12 rounded-full border-2",(c||p)&&"shadow-lg shadow-primary/30"),children:p?e.jsx(y.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:20},children:e.jsx(A,{className:"h-6 w-6 text-white"})}):e.jsx("span",{className:b("text-sm font-black",c?"text-white":"text-gray-400"),children:i.number})}),e.jsx(y.span,{animate:{color:c?"var(--color-primary)":"#9ca3af"},className:"mt-2 text-xs font-black uppercase tracking-widest",children:i.label})]}),m<d.length-1&&e.jsx("div",{className:"w-24 sm:w-32 h-0.5 mx-4 bg-gray-200 overflow-hidden",children:e.jsx(y.div,{initial:!1,animate:{width:p?"100%":"0%"},transition:{duration:.4},className:"h-full bg-primary"})})]},i.number)})})}),e.jsx("div",{className:"bg-white rounded-3xl border border-gray-100 shadow-2xl shadow-gray-200/50 p-6 sm:p-8 lg:p-12 overflow-hidden",children:e.jsx(_,{mode:"wait",children:e.jsx(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3,ease:"easeInOut"},children:d.find(i=>i.number===l)?.component},l)})})]})}export{Ve as M};
