import{d as U,j as e,B as h,K as ie,M as P,N as M,O as D,Q as z,V as g,X as C,Y as re,$ as ne,a0 as oe,a1 as le,a2 as de,a3 as ce,a4 as me,a5 as xe,r as L,a6 as y,f as T,a7 as he,a8 as B,a9 as q,t as c,w as ue,aa as pe,ab as W,ac as V,ad as R,ae as ge,af as fe,I as ye,L as Y,ag as we,q as ve,a as je,ah as be,ai as Ne,R as ke,aj as Ce,F as Ue}from"./index-uQ9GgSHU.js";import{u as Ie,A as Ee}from"./useAdEvents-C2sV8TmA.js";const Ae=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],Ve=U("facebook",Ae);const De=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],S=U("file-image",De);const Le=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]],Q=U("file-type",Le);const Se=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],Pe=U("instagram",Se);const Me=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],ze=U("link",Me),Re=({onDownload:i,onPreview:a,onShare:l,onCopyLink:n,mediaType:o})=>{const t=o==="VIDEO";return e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[a&&e.jsx(h,{onClick:a,variant:"secondary",className:"rounded-full h-10 w-10 p-0 shadow-lg bg-white/80 backdrop-blur-sm hover:bg-white text-gray-900",title:"Full Preview",children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsxs(P,{children:[e.jsx(M,{asChild:!0,children:e.jsx(h,{variant:"secondary",className:"rounded-full h-10 w-10 p-0 shadow-lg bg-white/80 backdrop-blur-sm hover:bg-white text-gray-900",children:e.jsx(D,{className:"h-4 w-4"})})}),e.jsxs(z,{className:"rounded-xl border-gray-100 p-2 shadow-xl",children:[t?e.jsxs(g,{onClick:()=>i("jpg"),className:"rounded-lg font-medium",children:[e.jsx(D,{className:"mr-2 h-4 w-4"})," Download Video"]}):e.jsxs(e.Fragment,{children:[e.jsxs(g,{onClick:()=>i("png"),className:"rounded-lg font-medium",children:[e.jsx(S,{className:"mr-2 h-4 w-4"})," PNG Image"]}),e.jsxs(g,{onClick:()=>i("jpg"),className:"rounded-lg font-medium",children:[e.jsx(S,{className:"mr-2 h-4 w-4"})," JPG Image"]})]}),e.jsxs(g,{onClick:()=>i("pdf"),className:"rounded-lg font-medium",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"})," PDF Report"]})]})]}),e.jsxs(P,{children:[e.jsx(M,{asChild:!0,children:e.jsx(h,{variant:"secondary",className:"rounded-full h-10 w-10 p-0 shadow-lg bg-white/80 backdrop-blur-sm hover:bg-white text-gray-900",children:e.jsx(C,{className:"h-4 w-4"})})}),e.jsxs(z,{className:"rounded-xl border-gray-100 p-2 shadow-xl",children:[e.jsxs(g,{onClick:l,className:"rounded-lg font-medium",children:[e.jsx(C,{className:"mr-2 h-4 w-4"})," Share via..."]}),e.jsxs(g,{onClick:n,className:"rounded-lg font-medium",children:[e.jsx(C,{className:"mr-2 h-4 w-4"})," Copy Link"]})]})]})]})},Fe=({variants:i,title:a,mediaType:l,onDownload:n,onShare:o,onCopyLink:t})=>{const m=l==="VIDEO",d=i.length>1,u=(r,x)=>{const p=r.includes("youtube.com")||r.includes("youtu.be"),s=r.toLowerCase().endsWith(".mp4")||r.toLowerCase().endsWith(".webm")||r.toLowerCase().endsWith(".mov")||r.toLowerCase().endsWith(".m4v")||r.includes("blob:")||r.toLowerCase().includes("_out")||r.includes("video")&&!r.includes("thumbnail");return m||p||s?e.jsx(xe,{src:r,className:"w-full h-full"}):e.jsx("img",{src:r,alt:`${a} - Variant ${x+1}`,className:"w-full h-full object-contain bg-black/5 aspect-square"})};return e.jsx(re,{className:"border-none shadow-2xl rounded-lg overflow-hidden bg-white",children:e.jsx(ne,{className:"p-0",children:e.jsxs("div",{className:"aspect-square relative group",children:[d?e.jsxs(oe,{className:"w-full h-full",children:[e.jsx(le,{className:"ml-0",children:i.map((r,x)=>e.jsx(de,{className:"pl-0",children:u(r,x)},x))}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-4 pointer-events-none",children:[e.jsx(ce,{className:"relative left-0 pointer-events-auto shadow-lg border-none bg-white/80 backdrop-blur-sm hover:bg-white"}),e.jsx(me,{className:"relative right-0 pointer-events-auto shadow-lg border-none bg-white/80 backdrop-blur-sm hover:bg-white"})]})]}):u(i[0],0),e.jsx(Re,{onDownload:n,onPreview:()=>window.open(i[0],"_blank"),onShare:o,onCopyLink:t,mediaType:l})]})})})},Te=B("relative overflow-hidden cursor-pointer inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{size:{default:"min-w-28 h-10 px-4 py-2",sm:"min-w-24 h-9 rounded-md gap-1.5 px-3",md:"min-w-28 h-10 px-4 py-2",lg:"min-w-32 h-11 px-8"},icon:{suffix:"pl-4",prefix:"pr-4"}},defaultVariants:{size:"default"}}),F={sm:16,md:20,lg:28,default:16};function Oe({children:i,className:a,size:l,icon:n,onIconClick:o,...t}){const[m,d]=L.useState(!1);return e.jsx(y.button,{className:T("bg-primary text-primary-foreground hover:bg-primary/90",Te({size:l,className:a,icon:n})),onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),...t,children:e.jsx(he,{initial:!1,mode:"wait",children:m?e.jsx(y.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},exit:{opacity:0,y:24},transition:{duration:.3},className:" absolute left-0 right-0 top-0 bottom-0 flex items-center justify-center gap-2",children:e.jsx(Ge,{size:l,onIconClick:o})},"icons"):e.jsxs(y.div,{initial:{opacity:1,y:0},animate:{opacity:1,y:0},exit:{opacity:0,y:-24},transition:{duration:.3},className:" absolute left-0 right-0 top-0 bottom-0 flex items-center justify-center gap-2",children:[n==="prefix"&&e.jsx(C,{className:"size-4",size:F[l]}),i,n==="suffix"&&e.jsx(C,{className:"size-4",size:F[l]})]},"content")})})}const _e=B("flex items-center justify-center gap-3",{variants:{size:{default:"text-[16px]",sm:"text-[16px]",md:"text-[20px]",lg:"text-[28px]"}},defaultVariants:{size:"default"}});function Ge({size:i="default",className:a,onIconClick:l}){const n=F[i],o=L.useCallback((t,m)=>{l?.(t,m)},[l]);return e.jsxs(y.div,{className:T(_e({size:i}),"group",a),children:[e.jsx(y.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},transition:{delay:0,duration:.5,type:"spring",bounce:.4},whileHover:{y:-8,transition:{duration:.2,ease:"easeOut"}},className:"group-hover:opacity-100 cursor-pointer py-3 rounded-lg box-border",onClick:t=>o("instagram",t),children:e.jsx(Pe,{size:n})}),e.jsx(y.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5,type:"spring",bounce:.4},whileHover:{y:-8,transition:{duration:.2,ease:"easeOut"}},className:"group-hover:opacity-100 cursor-pointer py-3 rounded-lg box-border",onClick:t=>o("facebook",t),children:e.jsx(Ve,{size:n})}),e.jsx(y.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5,type:"spring",bounce:.4},whileHover:{y:-8,transition:{duration:.2,ease:"easeOut"}},className:"group-hover:opacity-100 cursor-pointer py-3 rounded-lg box-border",onClick:t=>o("x",t),children:e.jsx(q,{size:n})}),e.jsx(y.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5,type:"spring",bounce:.4},whileHover:{y:-8,transition:{duration:.2,ease:"easeOut"}},className:"group-hover:opacity-100 cursor-pointer py-3 rounded-lg box-border",onClick:t=>o("link",t),children:e.jsx(ze,{size:n})})]})}const $e=({mediaType:i,shareUrl:a,mediaUrl:l,title:n,onDownload:o})=>{const t=i==="VIDEO",m=()=>{const r=l||a;window.open(r,"_blank")},d=async r=>{if(r==="pdf"){o(r);return}const x=l||a;if(!x){c.error("No media URL found for download");return}c.loading(`Downloading ${t?"video":"image"}...`,{id:"download-toast"});try{const p=await fetch(x);if(!p.ok)throw new Error("Network response was not ok");const s=await p.blob(),v=window.URL.createObjectURL(s),f=document.createElement("a");f.href=v;const b=x.split(".").pop()?.split(/[?#]/)[0]||(t?"mp4":r),w=n.toLowerCase().replace(/[^a-z0-9]/g,"-")||"ad-asset";f.download=`${w}.${b}`,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(v),c.success("Download successful",{id:"download-toast"})}catch(p){console.error("Download failed:",p),c.error("Download failed. Opening directly...",{id:"download-toast"}),window.open(x,"_blank")}},u=r=>{const x=encodeURIComponent(a),p=encodeURIComponent(n);switch(r){case"facebook":window.open(`https://www.facebook.com/sharer/sharer.php?u=${x}`,"_blank");break;case"x":window.open(`https://twitter.com/intent/tweet?url=${x}&text=${p}`,"_blank");break;case"instagram":case"link":navigator.clipboard.writeText(a).then(()=>{c.success(r==="instagram"?"Link copied! Share it on your Instagram Story or Bio.":"Link copied to clipboard!")});break}};return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(h,{onClick:m,variant:"outline",className:"w-full h-12 rounded-xl border-gray-200 font-bold text-sm hover:bg-gray-50 text-gray-900",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-3",children:[e.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"Full Preview"]}),e.jsxs(P,{children:[e.jsx(M,{asChild:!0,children:e.jsxs(h,{className:"w-full h-12 rounded-xl font-bold text-sm transition-all shadow-lg shadow-primary/10 bg-primary text-white hover:bg-primary/90",children:[e.jsx(D,{className:"mr-3 h-4 w-4"}),"Download ",t?"Video":"Image"]})}),e.jsxs(z,{className:"w-56 rounded-lg border-gray-100 p-2 shadow-xl",children:[t?e.jsx(g,{onClick:()=>d("jpg"),className:"rounded-md font-medium p-3 cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-md bg-indigo-50 flex items-center justify-center mr-3 text-indigo-500",children:e.jsx(D,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-900",children:"MP4 Video"}),e.jsx("div",{className:"text-[10px] text-gray-400",children:"High Quality"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>d("png"),className:"rounded-md font-medium p-3 cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-md bg-blue-50 flex items-center justify-center mr-3 text-blue-500",children:e.jsx(S,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-900",children:"PNG Image"}),e.jsx("div",{className:"text-[10px] text-gray-400",children:"High Quality"})]})]})}),e.jsx(g,{onClick:()=>d("jpg"),className:"rounded-md font-medium p-3 cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-md bg-orange-50 flex items-center justify-center mr-3 text-orange-500",children:e.jsx(S,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-900",children:"JPG Image"}),e.jsx("div",{className:"text-[10px] text-gray-400",children:"Compressed"})]})]})})]}),e.jsx(g,{onClick:()=>d("pdf"),className:"rounded-md font-medium p-3 cursor-pointer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-md bg-red-50 flex items-center justify-center mr-3 text-red-500",children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-900",children:"PDF Report"}),e.jsx("div",{className:"text-[10px] text-gray-400",children:"Analytics & Preview"})]})]})})]})]}),e.jsxs("div",{className:"pt-6 space-y-4",children:[e.jsx("div",{className:"h-px bg-gray-200"}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Share with your audience"}),e.jsx(Oe,{size:"lg",onIconClick:u,className:"w-full h-14 rounded-2xl shadow-xl shadow-primary/20",children:"Share Ad"})]})]})]})},H=({onBack:i,status:a,mediaType:l,onSave:n,onEdit:o,isSaving:t=!1})=>{const m=l==="VIDEO";return e.jsx("div",{className:"bg-white border-b border-gray-100 sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(h,{variant:"ghost",onClick:i,className:"text-gray-600 hover:text-gray-900",children:[e.jsx(ue,{className:"mr-2 h-4 w-4"}),"Back to History"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:T("px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider",a==="COMPLETED"&&"bg-green-50 text-green-600",a==="FAILED"&&"bg-red-50 text-red-600",a==="CANCELLED"&&"bg-gray-100 text-gray-500",(a==="PENDING"||a==="PROCESSING")&&"bg-yellow-50 text-yellow-600"),children:a}),e.jsx("span",{className:"px-3 py-1 bg-blue-50 rounded-full text-xs font-bold text-blue-600 uppercase tracking-wider",children:m?"Video Ad":"Image Ad"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[o&&e.jsxs(h,{variant:"outline",onClick:o,className:"flex items-center gap-2 border-gray-200",children:[e.jsx(pe,{className:"h-4 w-4"}),"Edit Ad"]}),n&&e.jsxs(h,{onClick:n,disabled:t,className:"flex items-center gap-2 bg-primary hover:bg-primary/90",children:[e.jsx(W,{className:"h-4 w-4"}),t?"Saving...":"Save Ad"]})]})]})})})},He=({mediaType:i})=>{const a=i==="VIDEO";return e.jsxs(V,{variants:R,className:"text-center space-y-4 mb-10",children:[e.jsx("div",{className:"bg-blue-500 text-white h-20 w-20 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(ge,{className:"h-10 w-10"})}),e.jsxs("h2",{className:"text-4xl sm:text-5xl font-black text-gray-900 tracking-tight",children:["Your ",a?"Video":"Image"," Ad is"," ",e.jsx("span",{className:"text-primary",children:"Ready"})]}),e.jsxs("p",{className:"text-base font-medium text-gray-600 max-w-md mx-auto",children:["Your ",a?"video":"image"," ad has been created successfully.",a?" Share your engaging video content across platforms.":" Download and share your stunning visuals."]})]})},Be=({title:i,isEditing:a,editedTitle:l,isUpdating:n,onStartEdit:o,onTitleChange:t,onSave:m,onCancel:d})=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Campaign Title"}),!a&&e.jsx(h,{variant:"ghost",size:"icon",onClick:o,className:"h-8 w-8 text-gray-400 hover:text-gray-900",children:e.jsx(fe,{className:"h-4 w-4"})})]}),a?e.jsxs("div",{className:"space-y-3",children:[e.jsx(ye,{value:l,onChange:u=>t(u.target.value),className:"text-xl font-bold",placeholder:"Enter campaign title",autoFocus:!0,onKeyDown:u=>{u.key==="Enter"&&m(),u.key==="Escape"&&d()}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{onClick:m,disabled:n,size:"sm",className:"flex-1",children:n?e.jsx(Y,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Save"]})}),e.jsxs(h,{onClick:d,variant:"outline",size:"sm",className:"flex-1",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Cancel"]})]})]}):e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:i||"Untitled Campaign"})]}),Je=()=>{const{adId:i}=we({strict:!1}),a=ve(),[l,n]=L.useState(!1),[o,t]=L.useState(""),{generatedAd:m}=je();Ie(i||null);const d=i?.startsWith("mock-demo-"),{data:u,isLoading:r,error:x}=be(d?void 0:i);console.log("Ad Response: ",m);const p=m?.data?.id===i?m.data:null,s=p||(d?m?.data:u?.data),{mutate:v,isPending:f}=Ne();if(ke.useEffect(()=>{s&&t(s.title||"Untitled Campaign")},[s]),r&&!d&&!p)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(Y,{className:"h-8 w-8 animate-spin text-primary"})});const O=async()=>{if(s?.id)try{await Ue.cancelAd(s.id),c.info("Generation cancelled"),a({to:"/ads/history"})}catch{c.error("Failed to cancel generation")}};if(s&&(s.status==="PENDING"||s.status==="PROCESSING"))return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(H,{onBack:()=>a({to:"/ads/history"}),status:s.status,mediaType:s.mediaType||"IMAGE",onSave:()=>{},onEdit:()=>a({to:`/ads/edit/${s.id}`}),isSaving:!1}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(Ee,{status:s.status,onCancel:O})})})]});if(x&&!d&&!s||!r&&!s&&!d)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Ad Not Found"}),e.jsx("p",{className:"text-gray-600",children:x?"Failed to load the ad. Please try again.":"The ad preview data is missing."}),e.jsx(h,{onClick:()=>a({to:"/ads/history"}),children:"Back to History"})]})});const b=window.location.origin+"/ads/preview/"+s.id,w=s.mediaType||"IMAGE",N=w==="VIDEO",I=(()=>{if(N){if(s.videoUrls&&s.videoUrls.length>0)return s.videoUrls;if(s.videoUrl)return[s.videoUrl];if(s.url)return[s.url];if(s.data?.videoUrls&&s.data.videoUrls.length>0)return s.data.videoUrls;if(s.data?.videoUrl)return[s.data.videoUrl]}if(s.generatedImages&&s.generatedImages.length>0)return s.generatedImages.map(j=>j.url);if(!N){if(s.imageUrls&&s.imageUrls.length>0)return s.imageUrls;if(s.imageUrl)return[s.imageUrl];if(s.data?.imageUrls&&s.data.imageUrls.length>0)return s.data.imageUrls;if(s.data?.imageUrl)return[s.data.imageUrl]}return["https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=800&auto=format&fit=crop&q=60"]})();N&&console.log("Video Ad Debug Info:",{adId:s.id,mediaType:s.mediaType,videoUrl:s.videoUrl,videoUrls:s.videoUrls,dataVideoUrl:s.data?.videoUrl,dataVideoUrls:s.data?.videoUrls,generatedImages:s.generatedImages,finalVariants:I});const J=async()=>{if(navigator.share)try{await navigator.share({title:s.title,text:s.description,url:b})}catch{}else _()},_=()=>{navigator.clipboard.writeText(b),c.success("Link copied to clipboard!")},G=async(j,ee)=>{if(j==="pdf"){c.info("Generating PDF report..."),setTimeout(()=>{c.success("PDF Report downloaded")},1500);return}const E=ee||s.videoUrl||s.imageUrl||s.previewUrl||I[0];if(!E){c.error("No media URL found for download");return}c.loading(`Downloading ${N?"video":"image"}...`,{id:"download-toast"});try{const A=await fetch(E);if(!A.ok)throw new Error("Network response was not ok");const se=await A.blob(),$=window.URL.createObjectURL(se),k=document.createElement("a");k.href=$;const ae=E.split(".").pop()?.split(/[?#]/)[0]||(N?"mp4":j),te=s.title?.toString().toLowerCase().replace(/[^a-z0-9]/g,"-")||"shopster-ad";k.download=`${te}.${ae}`,document.body.appendChild(k),k.click(),document.body.removeChild(k),window.URL.revokeObjectURL($),c.success("Download successful",{id:"download-toast"})}catch(A){console.error("Download failed:",A),c.error("Download failed handle. Opening directly...",{id:"download-toast"}),window.open(E,"_blank")}},K=()=>{if(!o.trim()){c.error("Title cannot be empty");return}v({id:s.id,title:o,status:s.status,variableValues:s.variableValues},{onSuccess:()=>{n(!1),c.success("Ad updated successfully!")}})},X=()=>{v({id:s.id,title:s.title||o,status:s.status,variableValues:s.variableValues},{onSuccess:()=>{c.success("Ad saved successfully!")},onError:()=>{c.error("Failed to save ad. Please try again.")}})},Z=()=>{t(s.title||"Untitled Campaign"),n(!1)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsx(H,{onBack:()=>a({to:"/ads/history"}),status:s.status||"PENDING",mediaType:w,onSave:X,onEdit:()=>a({to:`/ads/edit/${s.id}`}),isSaving:f}),e.jsxs(V,{variants:Ce,initial:"hidden",animate:"visible",className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[e.jsx(He,{mediaType:w}),s.status==="FAILED"&&e.jsxs("div",{className:"mb-10 bg-red-50 border border-red-200 rounded-xl p-6 flex flex-col md:flex-row items-center gap-6 animate-in fade-in slide-in-from-top-2",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center shrink-0",children:e.jsx("span",{className:"text-2xl",children:"⚠️"})}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h4",{className:"text-lg font-black text-gray-900 uppercase tracking-tight",children:"Generation Failed"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.metadata?.error||"An unexpected error occurred during ad generation."})]}),e.jsx(h,{onClick:()=>a({to:`/ads/edit/${s.id}`}),className:"px-6 h-10 bg-red-600 hover:bg-red-700 text-white border-none shadow-lg shadow-red-200",children:"Retry Settings"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-10",children:[e.jsx(V,{variants:R,className:"lg:col-span-3",children:e.jsx(Fe,{variants:I,title:s.title||"",mediaType:w,onDownload:G,onShare:J,onCopyLink:_})}),e.jsxs(V,{variants:R,className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"space-y-6",children:e.jsx(Be,{title:s.title||"",isEditing:l,editedTitle:o,isUpdating:f,onStartEdit:()=>n(!0),onTitleChange:t,onSave:K,onCancel:Z})}),e.jsx($e,{mediaType:w,shareUrl:b,mediaUrl:I[0],title:s.title,onDownload:G})]})]})]})]})};export{Je as default};
